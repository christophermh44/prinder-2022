<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üó≥Ô∏è</text></svg>">
    <title>Prinder‚ÄØ: pour qui voter en 2022‚ÄØ?</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <main id="vue-app">
        <h1>üó≥Ô∏è Prinder‚ÄØ: pour qui voter en 2022‚ÄØ? üá´üá∑</h1>
        <template v-if="step === 'start'">
            <p style="font-size: 130%;">
                ‚úî Lire les programmes des candidats, √ßa vous so√ªle‚ÄØ?<br>
                ‚úî Vous pr√©f√©rez vous concentrer sur des id√©es plut√¥t que sur les candidats‚ÄØ?<br>
                <strong>Vous avez bien raison‚ÄØ!</strong> (m√™me si vous savez pertinemment que les id√©es prononc√©es ne sont jamais toutes respect√©es‚Ä¶)
            </p>
            <button type="button" @click="go" style="background-color: aquamarine;">C'est parti‚ÄØ!</button>
            <h2>√Ä quoi sert ce site‚ÄØ?</h2>
            <p>
                J'ai √©pluch√© les programmes de la Pr√©sidentielle 2022 pour vous, en me basant sur les papiers que nous avons tous re√ßus dans notre bo√Æte aux lettres. J'ai isol√© les id√©es, √† vous de r√©pondre √† ce petit questionnaire.<br>
                √Ä la fin, ce site vous livrera quels sont les candidats de la Pr√©sidentielle qui matchent le mieux avec vous.
            </p>
            <details>
                <summary>Qui se pr√©sente en 2022‚ÄØ?</summary>
                <div class="cards">
                    <div class="card" v-for="candidate in candidates">
                        <img :src="candidate.logo" :alt="`Logo du parti de ${candidate.party}`" class="card__thumb">
                        <div class="card__body">
                            <div class="media">
                                <img :src="candidate.photo" :alt="`Photo de ${candidate.name}`" class="media__thumb">
                                <div class="media__title" v-text="candidate.name"></div>
                                <div class="media__details">
                                    <span class="tag" :style="{'--color': candidate.color}" v-text="candidate.party"></span><br>
                                    <a style="display: inline-block; margin-top: 5px;" :href="candidate.link" target="_blank" title="S'ouvre dans un nouvel onglet">Visiter le site du parti</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </details>
            <h2>Une derni√®re chose avant de commencer‚Ä¶</h2>
            <p>
                Aucune donn√©e sur ce site n'est collect√©e, pas m√™me les stats de fr√©quentation. Il n'y a aucune publicit√© et ce site est h√©berg√© par mon serveur perso. Les sources sont publiques <a href="https://github.com/christophermh44/prinder-2022">sur GitHub</a>.<br>
                Si vous pensez qu'il y a un probl√®me, n'h√©sitez pas √† m'envoyer un tweet <a href="https://twitter.com/krisdeschacals" target="_blank" title="S'ouvre dans un nouvel onglet">@KrisDesChacals</a>, mais je ne garantie pas d'y repondre.
            </p>
            <details>
                <summary>Plus de d√©tails sur la m√©thode de calcul</summary>
                <p>
                    Pour chaque id√©e qui vous sera pr√©sent√©e, vous pouvez donner les r√©ponses suivantes‚ÄØ:
                </p>
                <ul>
                    <li v-for="answer in answers"><span v-text="`${answer.label} ${answer.text}`"></span></li>
                </ul>
                <p>
                    Ces r√©ponses repr√©sentent l'opinion que vous avez sur l'id√©e propos√©e.
                </p>
                <ul>
                    <li>Si vous indiquez une opinion favorable √† une id√©e donn√©e, cela ajoute des "points" au candidat (ou aux candidats) qui propose cette id√©e.</li>
                    <li>Si, au contraire, vous indiquez une opinion d√©favorable, le (ou les) candidat qui propose cette id√©e se voit retirer des points.</li>
                    <li>Une r√©ponse neutre ne change rien au score du (ou des) candidat concern√©.</li>
                </ul>
                <p>
                    Une fois que vous avez r√©pondu √† toutes les questions‚ÄØ:
                </p>
                <ol>
                    <li>Puisque les scores des candidats peuvent √™tre n√©gatifs, on rajoute suffisamment de points √† tous les candidats (le m√™me nombre pour chacun d'entre eux), afin que le score le plus bas soit ramen√© √† 0.</li>
                    <li>Puis, √©tant donn√© que le nombre d'id√©es figurant sur les programmes officiels diff√®rent d'un candidat √† un autre, un ratio est appliqu√© afin de faire en sorte que la note maximale soit la m√™me pour tous les candidats.</li>
                    <li>Enfin, on transforme les notes obtenues en pourcentage. Plus ce pourcentage est √©lev√©, plus le candidat trouvera gr√¢ce √† vos yeux.</li>
                </ol>
                <p>
                    En cas d'ex-√¶quo, les candidats qui ont obtenu le m√™me score sont m√©lang√©s al√©atoirement afin que ce test n'induise pas de biais inutiles √† cause de la pr√©sentation des r√©sultats.
                </p>
            </details>
            <p>
                <em><strong>NB‚ÄØ: </strong> Il subsiste encore quelques biais possibles sur le r√©sultat qui vous sera donn√©. Notamment si un candidat partage une id√©e politique mentionn√©e dans ce questionnaire mais ne l'a pas fait figurer sur son programme. Gardez donc √† l'esprit que le r√©sultat qui vous sera donn√© est une tendance, mais il appartient √† vous seul de faire votre choix final.</em>
            </p>
        </template>
        <template v-else-if="step === 'questions'">
            <h2>C'est √† vous‚ÄØ!</h2>
            <dialog ref="dialog">
                <form method="dialog">
                    <template v-if="dialog">
                        <h3 v-text="dialog.question"></h3>
                        <p v-text="dialog.details"></p>
                        <a :href="dialog.link" target="_blank">En savoir plus (s'ouvre dans un nouvel onglet)</a>
                        <details ref="details">
                            <summary>Spoil‚ÄØ: qui promeut cette mesure dans son programme‚ÄØ?</summary>
                            <ul>
                                <li v-for="candidate in dialog.candidates">
                                    <span v-text="candidates.find(c => c.id === candidate).name"></span>
                                    <span class="tag" :style="{'--color': candidates.find(c => c.id === candidate).color}" v-text="candidates.find(c => c.id === candidate).party"></span>
                                </li>
                            </ul>
                        </details>
                    </template>
                    <menu>
                        <button value="cancel">Fermer</button>
                    </menu>
                </form>
            </dialog>
            <table>
                <thead>
                    <tr>
                        <th width="70">Id√©e</th>
                        <th width="30">√âvaluation</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="(question, index) in questions">
                        <td>
                            <strong v-text="question.question"></strong><br>
                            <button type="button" @click="showDetails(question)">Plus d'informations</button>
                        </td>
                        <td style="display: flex; flex-direction: column; justify-content: center;">
                            <div style="align-content: stretch; display: flex; flex-direction: column;">
                                <input style="margin-bottom: 0; padding-bottom: 5px;" type="range" min="0" max="1" :step="1 / (answers.length - 1)" list="answers" v-model.number="question.answer">
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px;">
                                    <span v-for="answer in answers" v-text="answer.label"></span>
                                </div>
                            </div>
                            <div style="text-align: center;">
                                <span v-text="answers.find(a => a.score === question.answer).label" style="margin-right: 5px;"></span>
                                <span v-text="answers.find(a => a.score === question.answer).text"></span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <datalist id="answers">
                <option v-for="answer in answers" :value="answer.score" :label="answer.label"></option>
            </datalist>
            <button type="button" @click="compute" style="background-color: aquamarine;">√âvaluer le r√©sultat</button>
        </template>
        <template v-else-if="step === 'finish'">
            <h2>Tada‚ÄØ! Voici vos r√©sultats‚ÄØ:</h2>
            <div class="results">
                <div class="results__item result result--0">
                    <div class="result__position" v-text="results[0].rank"></div>
                    <img class="result__photo" :src="results[0].photo" alt="">
                    <div class="result__details">
                        <div class="result__name" v-text="results[0].name"></div>
                        <img class="result__logo" :src="results[0].logo" alt="">
                    </div>
                </div>
                <div class="results__item result result--1">
                    <div class="result__position" v-text="results[1].rank"></div>
                    <img class="result__photo" :src="results[1].photo" alt="">
                    <div class="result__details">
                        <div class="result__name" v-text="results[1].name"></div>
                        <img class="result__logo" :src="results[1].logo" alt="">
                    </div>
                </div>
                <div class="results__item result result--2">
                    <div class="result__position" v-text="results[2].rank"></div>
                    <img class="result__photo" :src="results[2].photo" alt="">
                    <div class="result__details">
                        <div class="result__name" v-text="results[2].name"></div>
                        <img class="result__logo" :src="results[2].logo" alt="">
                    </div>
                </div>
            </div>
            <table>
                <thead>
                    <tr>
                        <th width="10"></th>
                        <th width="35">Candidat</th>
                        <th width="35">Parti</th>
                        <th width="20">Affinit√©</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="candidate in results">
                        <th v-text="candidate.rank" style="text-align: center;"></th>
                        <th v-text="candidate.name"></th>
                        <td>
                            <span class="tag" :style="{'--color': candidate.color}" v-text="candidate.party"></span>
                        </td>
                        <td style="align-items: center; display: flex; justify-content: space-between;">
                            <meter min="0" max="100" :value="~~(candidate.percentage)" style="flex-grow: 1; margin-right: 10px;"></meter>
                            <span style="width: 40px; text-align: right;" v-text="`${~~(candidate.percentage)}‚ÄØ%`"></span>
                        </td>
                    </tr>
                </tbody>
            </table>
            <button type="button" @click="step = 'start'">Revenir au d√©but</button>
        </template>
    </main>
    <script src="app.js" type="module"></script>
</body>
</html>